{"version":2,"kind":"Notebook","sha256":"3184f21bc0a6c945ef07af01a913465b541293b614853a0d570a715f626c18cd","slug":"notebooks.climate-modes-xeofs","location":"/notebooks/climate-modes-xeofs.ipynb","dependencies":[],"frontmatter":{"title":"Finding Climate Modes with EOFs","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Project Pythia Community","name":"Project Pythia Community"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/eofs-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/projectpythia/eofs-cookbook/blob/main/notebooks/climate-modes-xeofs.ipynb","edit_url":"https://github.com/projectpythia/eofs-cookbook/edit/main/notebooks/climate-modes-xeofs.ipynb","thumbnail":"/eofs-cookbook/build/oni-e92bc11d75fd4029cb63e8a963c3e5d3.png","exports":[{"format":"ipynb","filename":"climate-modes-xeofs.ipynb","url":"/eofs-cookbook/build/climate-modes-xeofs-1b7b818d756a3a2ef0363c068a5b77e5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A0npS5QrIi"}],"key":"nVVz7SEVhN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y1qpQFoZFt"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"oCqNQYTgWb"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we will identify and plot a few different modes of climate variability with the help of an EOF package that interfaces with Xarray called ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Q0TfWrqz9Z"},{"type":"link","url":"https://github.com/nicrie/xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zMrwPkWNad"}],"urlSource":"https://github.com/nicrie/xeofs","error":true,"key":"ksuMFJHhX5"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"p1yn5wgkK3"}],"key":"ws3SlTx7lt"}],"key":"cgxxOCfmKG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MN1FdMUtNL"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"JFUphJHc4N"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"N9OAFIlYbl"}],"key":"pdEuEJCQ4R"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IbBDO1RO4Z"}],"key":"lY3uxmh0xL"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wCrkWcIBUu"}],"key":"kyscahVD70"}],"key":"LoSuZKbgEW"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/xarray/xarray-intro","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WtjIrKs24C"}],"urlSource":"https://foundations.projectpythia.org/core/xarray/xarray-intro","key":"gTfQZLUp0h"}],"key":"JZwAGQ9VXu"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iK353JwKJT"}],"key":"t45dUUX0wi"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"V4orLdwhKV"}],"key":"F5uPQyxXYV"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"/notebooks/eof-intro","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Intro to EOFs","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ZaCkW9i1B5"}],"urlSource":"eof-intro","dataUrl":"/notebooks.eof-intro.json","internal":true,"protocol":"file","key":"wR7Rh5o7Q2"}],"key":"pZGAMjXJIM"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PACEcOTlAB"}],"key":"LAzqZhP5KI"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"Zxqjcd4vNz"}],"key":"XfiT2XUPQr"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"/notebooks/numpy-eofs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"EOFs with NumPy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"i82etZzFrX"}],"urlSource":"numpy-eofs","dataUrl":"/notebooks.numpy-eofs.json","internal":true,"protocol":"file","key":"s4rBGnClEE"}],"key":"mxSenx0SKs"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nq0UMA8Kzr"}],"key":"pDyvk2Y0YG"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"blVw8cgzFB"}],"key":"zKS9EuhqUo"}],"key":"GWlimZUh2s"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"zk3qIVlL9s"}],"key":"kklUTAfxAC"},{"type":"text","value":": 30 minutes","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ct8m3XMt02"}],"key":"BvqUG5fI5p"}],"key":"o6DOXVKUai"}],"key":"BQKIEg3Oj1"}],"key":"YorFUGhlRp"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mDuOim0GDK"}],"key":"bbMCjoNToh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rdRgpxeG6P"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"R6NChWflni"}],"key":"uwCKIM95aW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport xeofs as xe","key":"xRHIG9a56i"},{"type":"output","id":"UcINqG2N9C9mLHztJ6-NZ","data":[],"key":"K7geBDEtck"}],"key":"oCvven11bH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Accessing and preparing the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oqbN5CkaF9"}],"identifier":"accessing-and-preparing-the-data","label":"Accessing and preparing the data","html_id":"accessing-and-preparing-the-data","implicit":true,"key":"CSLVeNHyBA"}],"key":"NdyAVdRUwC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CbZpcKdCCA"},{"type":"link","url":"https://www.ncei.noaa.gov/products/extended-reconstructed-sst","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NOAA Extended Reconstructed Sea Surface Temperature version 5 (ERSSTv5)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BMfn2aFMij"}],"urlSource":"https://www.ncei.noaa.gov/products/extended-reconstructed-sst","key":"J3Ty0oSaLr"},{"type":"text","value":" monthly gridded dataset ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n04FVfB99D"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Huang:2017a","identifier":"huang:2017a","children":[{"type":"text","value":"Huang ","key":"wgt8VOS1Q8"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"Yp5QsvYWPg"}],"key":"fEwdKLgKvH"},{"type":"text","value":", 2017","key":"tNPWGx5P7u"}],"enumerator":"1","key":"Ik42qm3bRi"}],"key":"yjFPj8L5AV"},{"type":"text","value":", which is accessible using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f9TYWl589i"},{"type":"link","url":"https://www.opendap.org/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"OPeNDAP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wt1cQG9G6e"}],"urlSource":"https://www.opendap.org/","key":"opXlLwOfpm"},{"type":"text","value":". More information on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LLoiA7U0NW"},{"type":"link","url":"https://psl.noaa.gov/data/help/using_opendap.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"using OPeNDAP to access NOAA data can be found here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UQJ9GJXDoG"}],"urlSource":"https://psl.noaa.gov/data/help/using_opendap.html","key":"b8PYHFdhME"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YRSjn0Z8l1"}],"key":"ZG0Jhins9x"}],"key":"FgFmTKhdzj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_url = 'https://psl.noaa.gov/thredds/dodsC/Datasets/noaa.ersst.v5/sst.mnmean.nc'","key":"wYk8KmDa1k"},{"type":"output","id":"8NwaANmgmJieHeORgwxx-","data":[],"key":"KImrlLhHc8"}],"key":"kVehvtr8ic"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst = xr.open_dataset(data_url).sst\nsst","key":"SCXs6FPGAr"},{"type":"output","id":"IkhEIUYx-PuhKy8FaKasg","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mKeyError\u001b[39m                                  Traceback (most recent call last)\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/file_manager.py:219\u001b[39m, in \u001b[36mCachingFileManager._acquire_with_cache_info\u001b[39m\u001b[34m(self, needs_lock)\u001b[39m\n\u001b[32m    218\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m219\u001b[39m     file = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_cache\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_key\u001b[49m\u001b[43m]\u001b[49m\n\u001b[32m    220\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mKeyError\u001b[39;00m:\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/lru_cache.py:56\u001b[39m, in \u001b[36mLRUCache.__getitem__\u001b[39m\u001b[34m(self, key)\u001b[39m\n\u001b[32m     55\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m._lock:\n\u001b[32m---> \u001b[39m\u001b[32m56\u001b[39m     value = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_cache\u001b[49m\u001b[43m[\u001b[49m\u001b[43mkey\u001b[49m\u001b[43m]\u001b[49m\n\u001b[32m     57\u001b[39m     \u001b[38;5;28mself\u001b[39m._cache.move_to_end(key)\n\n\u001b[31mKeyError\u001b[39m: [<function _open_scipy_netcdf at 0x7fb72edcf600>, ('https://psl.noaa.gov/thredds/dodsC/Datasets/noaa.ersst.v5/sst.mnmean.nc',), 'r', (('mmap', None), ('version', 2)), 'bd951888-4836-4879-a038-c2dcfae1fbee']\n\nDuring handling of the above exception, another exception occurred:\n\n\u001b[31mFileNotFoundError\u001b[39m                         Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[3]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m sst = \u001b[43mxr\u001b[49m\u001b[43m.\u001b[49m\u001b[43mopen_dataset\u001b[49m\u001b[43m(\u001b[49m\u001b[43mdata_url\u001b[49m\u001b[43m)\u001b[49m.sst\n\u001b[32m      2\u001b[39m sst\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/api.py:596\u001b[39m, in \u001b[36mopen_dataset\u001b[39m\u001b[34m(filename_or_obj, engine, chunks, cache, decode_cf, mask_and_scale, decode_times, decode_timedelta, use_cftime, concat_characters, decode_coords, drop_variables, create_default_indexes, inline_array, chunked_array_type, from_array_kwargs, backend_kwargs, **kwargs)\u001b[39m\n\u001b[32m    584\u001b[39m decoders = _resolve_decoders_kwargs(\n\u001b[32m    585\u001b[39m     decode_cf,\n\u001b[32m    586\u001b[39m     open_backend_dataset_parameters=backend.open_dataset_parameters,\n\u001b[32m   (...)\u001b[39m\u001b[32m    592\u001b[39m     decode_coords=decode_coords,\n\u001b[32m    593\u001b[39m )\n\u001b[32m    595\u001b[39m overwrite_encoded_chunks = kwargs.pop(\u001b[33m\"\u001b[39m\u001b[33moverwrite_encoded_chunks\u001b[39m\u001b[33m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m)\n\u001b[32m--> \u001b[39m\u001b[32m596\u001b[39m backend_ds = \u001b[43mbackend\u001b[49m\u001b[43m.\u001b[49m\u001b[43mopen_dataset\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    597\u001b[39m \u001b[43m    \u001b[49m\u001b[43mfilename_or_obj\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    598\u001b[39m \u001b[43m    \u001b[49m\u001b[43mdrop_variables\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdrop_variables\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    599\u001b[39m \u001b[43m    \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mdecoders\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    600\u001b[39m \u001b[43m    \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    601\u001b[39m \u001b[43m\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    602\u001b[39m ds = _dataset_from_backend_dataset(\n\u001b[32m    603\u001b[39m     backend_ds,\n\u001b[32m    604\u001b[39m     filename_or_obj,\n\u001b[32m   (...)\u001b[39m\u001b[32m    615\u001b[39m     **kwargs,\n\u001b[32m    616\u001b[39m )\n\u001b[32m    617\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m ds\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/scipy_.py:395\u001b[39m, in \u001b[36mScipyBackendEntrypoint.open_dataset\u001b[39m\u001b[34m(self, filename_or_obj, mask_and_scale, decode_times, concat_characters, decode_coords, drop_variables, use_cftime, decode_timedelta, mode, format, group, mmap, lock)\u001b[39m\n\u001b[32m    393\u001b[39m store_entrypoint = StoreBackendEntrypoint()\n\u001b[32m    394\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m close_on_error(store):\n\u001b[32m--> \u001b[39m\u001b[32m395\u001b[39m     ds = \u001b[43mstore_entrypoint\u001b[49m\u001b[43m.\u001b[49m\u001b[43mopen_dataset\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    396\u001b[39m \u001b[43m        \u001b[49m\u001b[43mstore\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    397\u001b[39m \u001b[43m        \u001b[49m\u001b[43mmask_and_scale\u001b[49m\u001b[43m=\u001b[49m\u001b[43mmask_and_scale\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    398\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdecode_times\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdecode_times\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    399\u001b[39m \u001b[43m        \u001b[49m\u001b[43mconcat_characters\u001b[49m\u001b[43m=\u001b[49m\u001b[43mconcat_characters\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    400\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdecode_coords\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdecode_coords\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    401\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdrop_variables\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdrop_variables\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    402\u001b[39m \u001b[43m        \u001b[49m\u001b[43muse_cftime\u001b[49m\u001b[43m=\u001b[49m\u001b[43muse_cftime\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    403\u001b[39m \u001b[43m        \u001b[49m\u001b[43mdecode_timedelta\u001b[49m\u001b[43m=\u001b[49m\u001b[43mdecode_timedelta\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m    404\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    405\u001b[39m \u001b[38;5;28;01mreturn\u001b[39;00m ds\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/store.py:42\u001b[39m, in \u001b[36mStoreBackendEntrypoint.open_dataset\u001b[39m\u001b[34m(self, filename_or_obj, mask_and_scale, decode_times, concat_characters, decode_coords, drop_variables, set_indexes, use_cftime, decode_timedelta)\u001b[39m\n\u001b[32m     27\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mopen_dataset\u001b[39m(\n\u001b[32m     28\u001b[39m     \u001b[38;5;28mself\u001b[39m,\n\u001b[32m     29\u001b[39m     filename_or_obj: T_PathFileOrDataStore,\n\u001b[32m   (...)\u001b[39m\u001b[32m     38\u001b[39m     decode_timedelta=\u001b[38;5;28;01mNone\u001b[39;00m,\n\u001b[32m     39\u001b[39m ) -> Dataset:\n\u001b[32m     40\u001b[39m     \u001b[38;5;28;01massert\u001b[39;00m \u001b[38;5;28misinstance\u001b[39m(filename_or_obj, AbstractDataStore)\n\u001b[32m---> \u001b[39m\u001b[32m42\u001b[39m     \u001b[38;5;28mvars\u001b[39m, attrs = \u001b[43mfilename_or_obj\u001b[49m\u001b[43m.\u001b[49m\u001b[43mload\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m     43\u001b[39m     encoding = filename_or_obj.get_encoding()\n\u001b[32m     45\u001b[39m     \u001b[38;5;28mvars\u001b[39m, attrs, coord_names = conventions.decode_cf_variables(\n\u001b[32m     46\u001b[39m         \u001b[38;5;28mvars\u001b[39m,\n\u001b[32m     47\u001b[39m         attrs,\n\u001b[32m   (...)\u001b[39m\u001b[32m     54\u001b[39m         decode_timedelta=decode_timedelta,\n\u001b[32m     55\u001b[39m     )\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/common.py:366\u001b[39m, in \u001b[36mAbstractDataStore.load\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    347\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mload\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m    348\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"\u001b[39;00m\n\u001b[32m    349\u001b[39m \u001b[33;03m    This loads the variables and attributes simultaneously.\u001b[39;00m\n\u001b[32m    350\u001b[39m \u001b[33;03m    A centralized loading function makes it easier to create\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m    363\u001b[39m \u001b[33;03m    are requested, so care should be taken to make sure its fast.\u001b[39;00m\n\u001b[32m    364\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m    365\u001b[39m     variables = FrozenDict(\n\u001b[32m--> \u001b[39m\u001b[32m366\u001b[39m         (_decode_variable_name(k), v) \u001b[38;5;28;01mfor\u001b[39;00m k, v \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mget_variables\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m.items()\n\u001b[32m    367\u001b[39m     )\n\u001b[32m    368\u001b[39m     attributes = FrozenDict(\u001b[38;5;28mself\u001b[39m.get_attrs())\n\u001b[32m    369\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m variables, attributes\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/scipy_.py:246\u001b[39m, in \u001b[36mScipyDataStore.get_variables\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    244\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mget_variables\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[32m    245\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m FrozenDict(\n\u001b[32m--> \u001b[39m\u001b[32m246\u001b[39m         (k, \u001b[38;5;28mself\u001b[39m.open_store_variable(k, v)) \u001b[38;5;28;01mfor\u001b[39;00m k, v \u001b[38;5;129;01min\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mds\u001b[49m.variables.items()\n\u001b[32m    247\u001b[39m     )\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/scipy_.py:235\u001b[39m, in \u001b[36mScipyDataStore.ds\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m    233\u001b[39m \u001b[38;5;129m@property\u001b[39m\n\u001b[32m    234\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mds\u001b[39m(\u001b[38;5;28mself\u001b[39m) -> scipy.io.netcdf_file:\n\u001b[32m--> \u001b[39m\u001b[32m235\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_manager\u001b[49m\u001b[43m.\u001b[49m\u001b[43macquire\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/file_manager.py:201\u001b[39m, in \u001b[36mCachingFileManager.acquire\u001b[39m\u001b[34m(self, needs_lock)\u001b[39m\n\u001b[32m    186\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34macquire\u001b[39m(\u001b[38;5;28mself\u001b[39m, needs_lock: \u001b[38;5;28mbool\u001b[39m = \u001b[38;5;28;01mTrue\u001b[39;00m) -> T_File:\n\u001b[32m    187\u001b[39m \u001b[38;5;250m    \u001b[39m\u001b[33;03m\"\"\"Acquire a file object from the manager.\u001b[39;00m\n\u001b[32m    188\u001b[39m \n\u001b[32m    189\u001b[39m \u001b[33;03m    A new file is only opened if it has expired from the\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m    199\u001b[39m \u001b[33;03m        An open file object, as returned by ``opener(*args, **kwargs)``.\u001b[39;00m\n\u001b[32m    200\u001b[39m \u001b[33;03m    \"\"\"\u001b[39;00m\n\u001b[32m--> \u001b[39m\u001b[32m201\u001b[39m     file, _ = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_acquire_with_cache_info\u001b[49m\u001b[43m(\u001b[49m\u001b[43mneeds_lock\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    202\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m file\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/file_manager.py:225\u001b[39m, in \u001b[36mCachingFileManager._acquire_with_cache_info\u001b[39m\u001b[34m(self, needs_lock)\u001b[39m\n\u001b[32m    223\u001b[39m     kwargs = kwargs.copy()\n\u001b[32m    224\u001b[39m     kwargs[\u001b[33m\"\u001b[39m\u001b[33mmode\u001b[39m\u001b[33m\"\u001b[39m] = \u001b[38;5;28mself\u001b[39m._mode\n\u001b[32m--> \u001b[39m\u001b[32m225\u001b[39m file = \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_opener\u001b[49m\u001b[43m(\u001b[49m\u001b[43m*\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_args\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    226\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m._mode == \u001b[33m\"\u001b[39m\u001b[33mw\u001b[39m\u001b[33m\"\u001b[39m:\n\u001b[32m    227\u001b[39m     \u001b[38;5;66;03m# ensure file doesn't get overridden when opened again\u001b[39;00m\n\u001b[32m    228\u001b[39m     \u001b[38;5;28mself\u001b[39m._mode = \u001b[33m\"\u001b[39m\u001b[33ma\u001b[39m\u001b[33m\"\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/xarray/backends/scipy_.py:158\u001b[39m, in \u001b[36m_open_scipy_netcdf\u001b[39m\u001b[34m(filename, mode, mmap, version, flush_only)\u001b[39m\n\u001b[32m    155\u001b[39m             \u001b[38;5;28;01mraise\u001b[39;00m\n\u001b[32m    157\u001b[39m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[32m--> \u001b[39m\u001b[32m158\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mnetcdf_file\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfilename\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmode\u001b[49m\u001b[43m=\u001b[49m\u001b[43mmode\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmmap\u001b[49m\u001b[43m=\u001b[49m\u001b[43mmmap\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mversion\u001b[49m\u001b[43m=\u001b[49m\u001b[43mversion\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    159\u001b[39m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m e:  \u001b[38;5;66;03m# netcdf3 message is obscure in this case\u001b[39;00m\n\u001b[32m    160\u001b[39m     errmsg = e.args[\u001b[32m0\u001b[39m]\n\n\u001b[36mFile \u001b[39m\u001b[32m~/micromamba/envs/eofs-cookbook-dev/lib/python3.13/site-packages/scipy/io/_netcdf.py:251\u001b[39m, in \u001b[36mnetcdf_file.__init__\u001b[39m\u001b[34m(self, filename, mode, mmap, version, maskandscale)\u001b[39m\n\u001b[32m    249\u001b[39m \u001b[38;5;28mself\u001b[39m.filename = filename\n\u001b[32m    250\u001b[39m omode = \u001b[33m'\u001b[39m\u001b[33mr+\u001b[39m\u001b[33m'\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m mode == \u001b[33m'\u001b[39m\u001b[33ma\u001b[39m\u001b[33m'\u001b[39m \u001b[38;5;28;01melse\u001b[39;00m mode\n\u001b[32m--> \u001b[39m\u001b[32m251\u001b[39m \u001b[38;5;28mself\u001b[39m.fp = \u001b[38;5;28;43mopen\u001b[39;49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mfilename\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43mf\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[38;5;132;43;01m{\u001b[39;49;00m\u001b[43momode\u001b[49m\u001b[38;5;132;43;01m}\u001b[39;49;00m\u001b[33;43mb\u001b[39;49m\u001b[33;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m    252\u001b[39m \u001b[38;5;28;01mif\u001b[39;00m mmap \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[32m    253\u001b[39m     \u001b[38;5;66;03m# Mmapped files on PyPy cannot be usually closed\u001b[39;00m\n\u001b[32m    254\u001b[39m     \u001b[38;5;66;03m# before the GC runs, so it's better to use mmap=False\u001b[39;00m\n\u001b[32m    255\u001b[39m     \u001b[38;5;66;03m# as the default.\u001b[39;00m\n\u001b[32m    256\u001b[39m     mmap = (\u001b[38;5;129;01mnot\u001b[39;00m IS_PYPY)\n\n\u001b[31mFileNotFoundError\u001b[39m: [Errno 2] No such file or directory: 'https://psl.noaa.gov/thredds/dodsC/Datasets/noaa.ersst.v5/sst.mnmean.nc'","ename":"FileNotFoundError","evalue":"[Errno 2] No such file or directory: 'https://psl.noaa.gov/thredds/dodsC/Datasets/noaa.ersst.v5/sst.mnmean.nc'"}],"key":"TMjCNL9iyK"}],"key":"tLAaSYEddh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that the data looks as expected:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJGD5j45St"}],"key":"OWCIiCnucr"}],"key":"NYAHihOx4i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst.isel(time=0).plot()","key":"mxEAm6pQY6"},{"type":"output","id":"TDLvRYYmfkR2dAnT_Ew8U","data":[],"key":"unv81vniFd"}],"key":"En09CpUtYi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Before we modify the data, let’s do an EOF analysis on the whole dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dpAlG6G5M9"}],"key":"x9xVCQHKsp"}],"key":"oNGuIcgxIj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_model = xe.single.EOF(n_modes=4, use_coslat=True)\ns_model.fit(sst, dim='time')\ns_eofs = s_model.components()\ns_pcs = s_model.scores()\ns_expvar = s_model.explained_variance_ratio()","key":"Nwjem19fqN"},{"type":"output","id":"OpUNkPj4jGOkv69iugGOO","data":[],"key":"VdeuIdDyWL"}],"key":"ljWjVa5Qp0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_eofs.plot(col='mode')","key":"hCj1bGMXUA"},{"type":"output","id":"uJeZomamzgzyFL3C9Ob3Z","data":[],"key":"jzCc6eqS1N"}],"key":"HpRBhv3AfV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_pcs.plot(col='mode')","key":"HJ2RMc6AaN"},{"type":"output","id":"4D1DS_Dz8oexHY-7fYWEe","data":[],"key":"KnRQlJTqzw"}],"key":"bxXdaSyHH4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_expvar","key":"m0Pmu6x1Wy"},{"type":"output","id":"Tzuc_8-z8Tpy28UHEC5Ba","data":[],"key":"RaUKn6nsdb"}],"key":"ZHdFok0oDF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EOF1 explains 83% of the variance, and the map shows interhemispheric asymmetry. The corresponding PC has a period of one year, which we can see more clearly by only plotting a few years:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iCt23LGR59"}],"key":"rk5BmHh8Da"}],"key":"IRywrg5Qf7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_pcs.sel(mode=1, time=slice('1900', '1903')).plot(figsize=(8, 3))","key":"HGjbJpnDsD"},{"type":"output","id":"ztlghCT8tONVLilGPWfkJ","data":[],"key":"Ftobk9kw4t"}],"key":"wBesAhNMgu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This mode is showing the seasonal cycle. This is interesting, but it obfuscates other modes. If we want to study the other ways Earth’s climate varies, we should remove the seasonal cycle from our data. Here we compute this (calling it the SST anomaly) by subtracting out the average of each month using Xarray’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dZAwMIa9XM"},{"type":"inlineCode","value":".groupby()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CEPU5x9LHT"},{"type":"text","value":" method:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nBsKRYtWwG"}],"key":"pCIiBsnWPc"}],"key":"Ra1rjU5FlC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst_clim = sst.groupby('time.month')\nssta = sst_clim - sst_clim.mean(dim='time')","key":"afgJGRTorn"},{"type":"output","id":"nIoc8bWxeeKPaAqZ7erFL","data":[],"key":"WmVwry1NHJ"}],"key":"DL23chjLhT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The remaining 3 EOFs show a combination of the long-term warming trend, the seasonal cycle (EOF analyses do not cleanly separate physical modes), and other internal variability. The warming trend is also interesting (see the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qDnFyjubAf"},{"type":"link","url":"https://projectpythia.org/cmip6-cookbook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CMIP6 Cookbook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zqajXRUZH5"}],"urlSource":"https://projectpythia.org/cmip6-cookbook","key":"zhE3SSaTSu"},{"type":"text","value":"), but here we want to pull out some modes of internal/natural variability. We can detrend the data by removing the global average SST anomaly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e9WVw3fF9r"}],"key":"xEDKTJfmdQ"}],"key":"lEfXF1jSCh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def global_average(data):\n    weights = np.cos(np.deg2rad(data.lat))\n    data_weighted = data.weighted(weights)\n    return data_weighted.mean(dim=['lat', 'lon'], skipna=True)","key":"NMUO5okFqQ"},{"type":"output","id":"H5TOGjBXIaolwYPOe0Qf7","data":[],"key":"grP06MFuvh"}],"key":"qFmagKAMMW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ssta_dt = (ssta - global_average(ssta)).squeeze()","key":"IvtbFoJs2P"},{"type":"output","id":"YEGPzGZxz4hpk3Rt57b-5","data":[],"key":"vhSg8I0mWc"}],"key":"WABirjC4wV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s find the global EOFs again but with the deseasonalized, detrended data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vYe55c4oAM"}],"key":"gHBzuuHRHK"}],"key":"ipnK8RHIub"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_model = xe.single.EOF(n_modes=4, use_coslat=True)\nds_model.fit(ssta_dt, dim='time')\nds_eofs = ds_model.components()\nds_pcs = ds_model.scores()\nds_expvar = ds_model.explained_variance_ratio()","key":"k2dsXuQOIS"},{"type":"output","id":"07xRMiRCDQ6ZRyaquYzKB","data":[],"key":"cvLUnWKjoP"}],"key":"RFxA2fp1o6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_eofs.plot(col='mode')","key":"pXs2i2Scw1"},{"type":"output","id":"N8ajxgkwPXMvVR3_wgiNy","data":[],"key":"EYpfM2gw7u"}],"key":"ay0P2mHv7Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_pcs.plot(col='mode')","key":"GVpajAFPij"},{"type":"output","id":"Y8OHEhEP18Ll7fUiZqbLX","data":[],"key":"WNBv7XwPOC"}],"key":"rhWewbmtAw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_expvar","key":"ll9muMRfRD"},{"type":"output","id":"1G7qrRRf7ZIkTQspRUfKG","data":[],"key":"tw76HwhWls"}],"key":"kXptJ92Ktc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can see some modes of variability! EOF1 looks like ENSO or IPO, and EOF2 is probably picking up a pattern of the recent temperature trend where the Southern Ocean and southeastern Pacific are slightly cooling. EOF3 and EOF4 appear to be showing some decadal modes of variability (PDO and maybe AMO), among other things. There is a lot going on in each of these maps, so to get a clearer index of some modes, we can restrict our domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BcXSC3oAZK"}],"key":"gk1mQgclYn"}],"key":"WuVuXufa0R"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"El Niño Southern Oscillation (ENSO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XQIMh08QAp"}],"identifier":"el-ni-o-southern-oscillation-enso","label":"El Niño Southern Oscillation (ENSO)","html_id":"el-ni-o-southern-oscillation-enso","implicit":true,"key":"vOpndt12dA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we restrict our domain to the equatorial Pacific. Note that ENSO is commonly defined using an index of SST anomaly over a region of the equatorial Pacific (e.g., the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PxPcVLTtUa"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/enso/sst","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Oceanic Niño Index (ONI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NKZ6EPaPXF"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/enso/sst","key":"gUhW9PJCSc"},{"type":"text","value":") instead of an EOF. You can ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"R2o6eeU0iz"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/enso/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"read more about ENSO here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MYPSmruI5Z"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/enso/","key":"LwXADTmkt9"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sJQmUV0A9s"}],"key":"mPU3OTBbbr"}],"key":"Ofo7pT0eFe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_ssta_dt = ssta_dt.where((ssta_dt.lat < 30) & (ssta_dt.lat > -30) & (ssta_dt.lon > 120) & (ssta_dt.lon < 290), drop=True)","key":"iCY9WB1cW8"},{"type":"output","id":"JwYObg2A6SUg_ZL_2yJBU","data":[],"key":"H7AAlvZsgt"}],"key":"XvZNDWjUzf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_model = xe.single.EOF(n_modes=4, use_coslat=True)\nep_model.fit(ep_ssta_dt, dim='time')\nep_eofs = ep_model.components()\nep_pcs = ep_model.scores()\nep_expvar = ep_model.explained_variance_ratio()","key":"SBhfbq3kkS"},{"type":"output","id":"cP0a0W9klXxsV3Co_DMvj","data":[],"key":"QlKDIlP6ua"}],"key":"bM09dEMN48"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_eofs.plot(col='mode')","key":"nSyIcTvvlZ"},{"type":"output","id":"_hBccce1u7spCVTa4NVm1","data":[],"key":"IkF91VlCAT"}],"key":"UHbfKBlwY6"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"ep_pcs.plot(col='mode')","key":"C02qWqWeDp"},{"type":"output","id":"vxC3-H9q_HJTHXvQYvFFy","data":[],"key":"VoTRdHE5vv"}],"key":"uCkXVCfbZ7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_expvar","key":"lv7bEeIxez"},{"type":"output","id":"O5bwT8W88uiPa20qo8d-9","data":[],"key":"K2toXlZiIz"}],"key":"PMb4SqdI5w"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) < 0), color='b')\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(ep_pcs.time.min(), ep_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('ENSO Index (detrended equatorial Pacific SSTA EOF1)')","key":"yWet7IVXOZ"},{"type":"output","id":"9pDxcs1loMedPV03TIGwY","data":[],"key":"SKpIQMyE94"}],"key":"UIPPyihwxP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare to the ONI:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m9cCWPQ4gM"}],"key":"R0T0PXCsoy"}],"key":"u0PjQir6ao"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) < 0), color='b')\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(ep_pcs.time.sel(time='1950-01').squeeze(), ep_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('ENSO Index (detrended equatorial Pacific SSTA EOF1)')","key":"bdIXxtmsYo"},{"type":"output","id":"264oxxb6GCTO1wmEX0L9R","data":[],"key":"UoQ5psyQSL"}],"key":"ASODntHMDS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/eofs-cookbook/build/oni-e92bc11d75fd4029cb63e8a963c3e5d3.png","alt":"ONI","key":"X71hV3uZn5","urlSource":"images/oni.png"}],"key":"LqdPglmL7n"}],"key":"LoLeBKpZM4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Pacific Decadal Oscillation (PDO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZtXkbzOiIx"}],"identifier":"pacific-decadal-oscillation-pdo","label":"Pacific Decadal Oscillation (PDO)","html_id":"pacific-decadal-oscillation-pdo","implicit":true,"key":"qwxWUaA0dV"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we restrict our domain to the North Pacific. You can ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RKrJj25Q0F"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/pdo/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"read more about PDO here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pt8i9hmZxh"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/pdo/","key":"oUiBNgRNXv"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AHGMZaTivS"}],"key":"io3331mZFY"}],"key":"GrdPDLQDWC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_ssta_dt = ssta_dt.where((ssta_dt.lat < 70) & (ssta_dt.lat > 20) & (ssta_dt.lon > 120) & (ssta_dt.lon < 260), drop=True)","key":"OMbTLayo5J"},{"type":"output","id":"fUoxF6bnn9Oo6LldmQAPj","data":[],"key":"v0IWePg0sc"}],"key":"fPk0DQPmwE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_model = xe.single.EOF(n_modes=4, use_coslat=True)\nnp_model.fit(np_ssta_dt, dim='time')\nnp_eofs = np_model.components()\nnp_pcs = np_model.scores()\nnp_expvar = np_model.explained_variance_ratio()","key":"nggIfkLsjT"},{"type":"output","id":"o12-_3VRwseK7Pm7ZwTcW","data":[],"key":"KhXVFMv0fM"}],"key":"FOMiCCN1pn"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"np_eofs.plot(col='mode')","key":"xulMNGM8JV"},{"type":"output","id":"Y1NsR6iPmmcsssV95d2Ss","data":[],"key":"hln4g0jZck"}],"key":"u5B9tJDr9l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_pcs.plot(col='mode')","key":"UzDsATarzS"},{"type":"output","id":"zzB-FROUq7fybFQyXil21","data":[],"key":"t42MHoyvoe"}],"key":"WBHcaV8wPI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_expvar","key":"idT7fYLzWV"},{"type":"output","id":"RiEqgqJKyXjrUv-FbSvGE","data":[],"key":"g5k8uynN9X"}],"key":"KQXVqz632Q"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(np_pcs.time, np_pcs.isel(mode=0).where(np_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(np_pcs.time, np_pcs.isel(mode=0).where(np_pcs.isel(mode=0) < 0), color='b')\nplt.plot(np_pcs.time, np_pcs.isel(mode=0).rolling(time=48, center=True).mean(), color='k', linewidth=2)\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(np_pcs.time.min(), np_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('PDO Index (detrended North Pacific SSTA EOF1)')","key":"hAhavM0c8w"},{"type":"output","id":"el580UrDDybIND_s7hX6s","data":[],"key":"v2ukyUCBFV"}],"key":"fHKtxLnMNw"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JMaKyjtHPz"}],"key":"J9FdN2eqvR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lBC8l7qgNm"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"thXnNEe09t"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we demonstrated a basic workflow for performing an EOF analysis on gridded SST data using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hX9Daur1UQ"},{"type":"inlineCode","value":"xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"iqYLafTMnV"},{"type":"text","value":" package. We plotted the PCs associated with ENSO and PDO using deseasonalized, detrended SSTs.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dYEdsiNgfG"}],"key":"RHC1gacfCI"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"iSvQOxBKwd"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"owZ4lN8s6q"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the future, additional notebooks may use EOFs to recreate published figures, give an overview of other EOF packages, or explore variations of the EOF method.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UNaiDUsXAz"}],"key":"l6HkIoHDyG"}],"key":"VRGua2w2Ft"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WzqGtJ6vaA"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"Wx9AnmsvaG"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Scientific description of the ERSSTv5 data set: ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"a3sWlXnNNJ"},{"type":"cite","url":"https://doi.org/10.1175/jcli-d-16-0836.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Huang et al. (2017), doi:10.1175/jcli-d-16-0836.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VmENThviw2"}],"kind":"narrative","label":"Huang:2017a","identifier":"https://doi.org/10.1175/jcli-d-16-0836.1","enumerator":"1","key":"EmlZ2TlehX"}],"key":"PaCOmJFUtW"}],"key":"xFm4mgcWkM"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://xeofs.readthedocs.io/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"xeofs documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pIpxyyTSN6"}],"urlSource":"https://xeofs.readthedocs.io/","key":"lfe6SEGGcP"}],"key":"MLgfROCM0k"}],"key":"kUBvJLfJRF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Paper describing the xeofs software: ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"b2Z5sE76zd"},{"type":"cite","url":"https://doi.org/10.21105/joss.06060","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Rieger et al., (2024) doi:10.21105/joss.06060","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TsDzRGIRds"}],"kind":"narrative","label":"Rieger:2024a","identifier":"https://doi.org/10.21105/joss.06060","enumerator":"2","key":"fk1H0yQhGA"}],"key":"kmVsxRLGsu"}],"key":"IlGOIXhKgc"}],"key":"qSrUkNjiyp"}],"key":"xpEgdnH9Q9"}],"key":"hsQ1HOMBYF"},"references":{"cite":{"order":["Huang:2017a","Rieger:2024a"],"data":{"Huang:2017a":{"label":"Huang:2017a","enumerator":"1","doi":"10.1175/JCLI-D-16-0836.1","html":"Huang, B., Thorne, P. W., Banzon, V. F., Boyer, T., Chepurin, G., Lawrimore, J. H., Menne, M. J., Smith, T. M., Vose, R. S., & Zhang, H.-M. (2017). Extended Reconstructed Sea Surface Temperature, Version 5 (ERSSTv5): Upgrades, Validations, and Intercomparisons. <i>Journal of Climate</i>, <i>30</i>(20), 8179–8205. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/JCLI-D-16-0836.1\">10.1175/JCLI-D-16-0836.1</a>","url":"https://doi.org/10.1175/JCLI-D-16-0836.1"},"Rieger:2024a":{"label":"Rieger:2024a","enumerator":"2","doi":"10.21105/joss.06060","html":"Rieger, N., & Levang, S. J. (2024). xeofs: Comprehensive EOF analysis in Python with xarray. <i>Journal of Open Source Software</i>, <i>9</i>(93), 6060. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.21105/joss.06060\">10.21105/joss.06060</a>","url":"https://doi.org/10.21105/joss.06060"}}}},"footer":{"navigation":{"prev":{"title":"EOFs with NumPy","url":"/notebooks/numpy-eofs","group":"Foundations"}}},"domain":"http://localhost:3000"}