{"version":2,"kind":"Notebook","sha256":"3184f21bc0a6c945ef07af01a913465b541293b614853a0d570a715f626c18cd","slug":"notebooks.climate-modes-xeofs","location":"/notebooks/climate-modes-xeofs.ipynb","dependencies":[],"frontmatter":{"title":"Finding Climate Modes with EOFs","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"id":"Project Pythia Community","name":"Project Pythia Community"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/eofs-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/eofs-cookbook/blob/main/notebooks/climate-modes-xeofs.ipynb","thumbnail":"/eofs-cookbook/build/oni-4f6f78161ab1229fb3c503cb792e79ba.png","exports":[{"format":"ipynb","filename":"climate-modes-xeofs.ipynb","url":"/eofs-cookbook/build/climate-modes-xeofs-5e136374bf35c7b5a90c9e2441a48fa2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AwZI3UBFYF"}],"key":"P8wUW4Hj8E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jllwWb5fSB"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"Gh29LdJv9h"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we will identify and plot a few different modes of climate variability with the help of an EOF package that interfaces with Xarray called ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NcnUrMLRvO"},{"type":"link","url":"https://github.com/nicrie/xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NmcwXh2vFt"}],"urlSource":"https://github.com/nicrie/xeofs","error":true,"key":"VrvUQxiWwW"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"P7tVsDkLqE"}],"key":"d6hW1DNUR6"}],"key":"XpEerrVXvQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mBpCu9UgVf"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"ZqGlEjwCkq"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ybm2Qp5prD"}],"key":"YfffyWhBfs"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qb91IdH49L"}],"key":"go2O8p04gV"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kjUxt0FsRQ"}],"key":"SU8hnIUs5P"}],"key":"cYU3ZXbOeH"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/xarray/xarray-intro","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"F0416yr66q"}],"urlSource":"https://foundations.projectpythia.org/core/xarray/xarray-intro","key":"uYWZotImEY"}],"key":"wilQ6L6Gug"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DX5OIrMRFR"}],"key":"tR5sfPc14X"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"yZlL7fUp6C"}],"key":"FcxZEuiiXZ"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"/notebooks/eof-intro","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Intro to EOFs","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CzSFAbY72p"}],"urlSource":"eof-intro","dataUrl":"/notebooks.eof-intro.json","internal":true,"protocol":"file","key":"HTujBCFZQY"}],"key":"Ts3G6t6liG"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dPLG4GNLz3"}],"key":"BMSgLmyJPv"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[],"key":"f9PemPIoJk"}],"key":"dv4sk22aIp"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"/notebooks/numpy-eofs","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"EOFs with NumPy","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Pbq4TmNYf5"}],"urlSource":"numpy-eofs","dataUrl":"/notebooks.numpy-eofs.json","internal":true,"protocol":"file","key":"M1yvry1Nxh"}],"key":"XSDFdWLR0V"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z6AK7CMaTs"}],"key":"fgLvFwdShk"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"MSZOxRPOwy"}],"key":"mDtcO8HtVN"}],"key":"cFvwVJ8QXv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"G1R4Hf38Zo"}],"key":"RP1CMk8N5u"},{"type":"text","value":": 30 minutes","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Gff48kpVMr"}],"key":"ZomYildT6z"}],"key":"QDnx0kHdfC"}],"key":"NzD0tLdwgH"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i4E2RAewj1"}],"key":"cCD5d6jkGK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CtCeZ7cuEm"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"htdb1h3qga"}],"key":"dVjwkpzwT0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport xarray as xr\nimport matplotlib.pyplot as plt\nimport xeofs as xe","key":"wBawvIXS9K"},{"type":"output","id":"-qTKGPfI5VnYYP_39tCYY","data":[],"key":"U7SGgceXcj"}],"key":"eZlN8AwWTb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Accessing and preparing the data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wLswOKiNal"}],"identifier":"accessing-and-preparing-the-data","label":"Accessing and preparing the data","html_id":"accessing-and-preparing-the-data","implicit":true,"key":"VxfwhzkiB1"}],"key":"NoA504ZW7z"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We will use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H7Dyvgp1Qo"},{"type":"link","url":"https://www.ncei.noaa.gov/products/extended-reconstructed-sst","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"NOAA Extended Reconstructed Sea Surface Temperature version 5 (ERSSTv5)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dr3LUCJgOR"}],"urlSource":"https://www.ncei.noaa.gov/products/extended-reconstructed-sst","key":"YKKPyeYisf"},{"type":"text","value":" monthly gridded dataset ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rs8UXPjJRK"},{"type":"citeGroup","kind":"parenthetical","children":[{"type":"cite","kind":"parenthetical","label":"Huang:2017a","identifier":"huang:2017a","children":[{"type":"text","value":"Huang ","key":"px4ZJvIOB2"},{"type":"emphasis","children":[{"type":"text","value":"et al.","key":"u8eivl5RGi"}],"key":"yW4EHhxCdw"},{"type":"text","value":", 2017","key":"TBy56IBdvk"}],"enumerator":"1","key":"tTzuIMOZpo"}],"key":"Z7TdU34UiS"},{"type":"text","value":", which is accessible using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M9LZ69FiGC"},{"type":"link","url":"https://www.opendap.org/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"OPeNDAP","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jkm3Yynvsb"}],"urlSource":"https://www.opendap.org/","key":"Sk198R2dEW"},{"type":"text","value":". More information on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pyna9waApc"},{"type":"link","url":"https://psl.noaa.gov/data/help/using_opendap.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"using OPeNDAP to access NOAA data can be found here","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fj1EhBhjJT"}],"urlSource":"https://psl.noaa.gov/data/help/using_opendap.html","key":"xPaGyGLyeX"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uP7fXbIeGc"}],"key":"PtQUsHaUfN"}],"key":"r2xxLBAUqp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data_url = 'https://psl.noaa.gov/thredds/dodsC/Datasets/noaa.ersst.v5/sst.mnmean.nc'","key":"GuAfTdyzGA"},{"type":"output","id":"OvSk9NqbeaJn6eXlXlunw","data":[],"key":"BBGI4tkNSe"}],"key":"osnhQcMdMp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst = xr.open_dataset(data_url).sst\nsst","key":"nTazHI0RYd"},{"type":"output","id":"Q8WrFYfB1Z7g62Q1Pst_6","data":[],"key":"WCZmetI91p"}],"key":"Dc5xFEYTr5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check that the data looks as expected:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mly6Hlr9k2"}],"key":"HkFyWuow6B"}],"key":"yK51ijvnQs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst.isel(time=0).plot()","key":"pyo4iH0WHy"},{"type":"output","id":"rXuKKK5DOfs32nAbLK-ei","data":[],"key":"yHQ4rub9e9"}],"key":"da8RKTlSE0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Before we modify the data, let’s do an EOF analysis on the whole dataset:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V5zE5ebxSe"}],"key":"Xl8ma8UtkV"}],"key":"CLE4aywOcl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_model = xe.single.EOF(n_modes=4, use_coslat=True)\ns_model.fit(sst, dim='time')\ns_eofs = s_model.components()\ns_pcs = s_model.scores()\ns_expvar = s_model.explained_variance_ratio()","key":"f2gXcnlssa"},{"type":"output","id":"DFtic16lS7GQzOtafmKYM","data":[],"key":"PmthrzN3RN"}],"key":"HeBqASNQ2F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_eofs.plot(col='mode')","key":"o4gMlgjFtA"},{"type":"output","id":"vbTRP66k3C0GnDQlXZ2oW","data":[],"key":"ZEyHoCzd4F"}],"key":"uvCkFIJr2F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_pcs.plot(col='mode')","key":"jAcPlIJVaM"},{"type":"output","id":"vxa5ctLdz5wAkFyBfpKkI","data":[],"key":"Qm4lhB7WwM"}],"key":"N1osMBfyji"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_expvar","key":"oUVIlBtNV4"},{"type":"output","id":"UH_S4vs0hLGgealh86_TR","data":[],"key":"r2PVeNusBS"}],"key":"i8F8pSDJky"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EOF1 explains 83% of the variance, and the map shows interhemispheric asymmetry. The corresponding PC has a period of one year, which we can see more clearly by only plotting a few years:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WbNJZy98Ma"}],"key":"yhgvBdH96X"}],"key":"bgv2qCmGnT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s_pcs.sel(mode=1, time=slice('1900', '1903')).plot(figsize=(8, 3))","key":"Qy64qYj4Yb"},{"type":"output","id":"hBJF35kpjZOv8K5kmyU1W","data":[],"key":"LXqgCXb1os"}],"key":"q1DXfmvl5f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This mode is showing the seasonal cycle. This is interesting, but it obfuscates other modes. If we want to study the other ways Earth’s climate varies, we should remove the seasonal cycle from our data. Here we compute this (calling it the SST anomaly) by subtracting out the average of each month using Xarray’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qqnhoxXOEb"},{"type":"inlineCode","value":".groupby()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ehS5inPAdY"},{"type":"text","value":" method:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jO4tg8VqeH"}],"key":"dS5I5KcJv5"}],"key":"jB8FFJdGAk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sst_clim = sst.groupby('time.month')\nssta = sst_clim - sst_clim.mean(dim='time')","key":"jHgaQiSRD1"},{"type":"output","id":"tWpW3Dw1sPdn7Q_l7qg_v","data":[],"key":"uAzzl8tUmP"}],"key":"XP7hnbzo2W"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The remaining 3 EOFs show a combination of the long-term warming trend, the seasonal cycle (EOF analyses do not cleanly separate physical modes), and other internal variability. The warming trend is also interesting (see the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VoWJR9Fw2M"},{"type":"link","url":"https://projectpythia.org/cmip6-cookbook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"CMIP6 Cookbook","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bfF3xrxpAU"}],"urlSource":"https://projectpythia.org/cmip6-cookbook","key":"CVTrWHfEtB"},{"type":"text","value":"), but here we want to pull out some modes of internal/natural variability. We can detrend the data by removing the global average SST anomaly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PwIT3JWOFX"}],"key":"xPs6LXB7qQ"}],"key":"EFn0kZyJiX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def global_average(data):\n    weights = np.cos(np.deg2rad(data.lat))\n    data_weighted = data.weighted(weights)\n    return data_weighted.mean(dim=['lat', 'lon'], skipna=True)","key":"E8XwkvnbKa"},{"type":"output","id":"ffcpHKqQwoFJw6Rf7Cqjh","data":[],"key":"X3Q1RCueRq"}],"key":"jP4dqTYXDe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ssta_dt = (ssta - global_average(ssta)).squeeze()","key":"TbKMx7rSq5"},{"type":"output","id":"4qkZQryzQ7aqVRwLJ4kkK","data":[],"key":"x0IBMlvhwF"}],"key":"pvEW5AHdg8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s find the global EOFs again but with the deseasonalized, detrended data:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SohKBOtuR9"}],"key":"pPEZbo5tbC"}],"key":"PDLbjvz0QY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_model = xe.single.EOF(n_modes=4, use_coslat=True)\nds_model.fit(ssta_dt, dim='time')\nds_eofs = ds_model.components()\nds_pcs = ds_model.scores()\nds_expvar = ds_model.explained_variance_ratio()","key":"jtcIUEasGK"},{"type":"output","id":"WdV9Qyin0n4gZDG_Ru_WH","data":[],"key":"fo7sZIRz9m"}],"key":"m1G2bbPn3S"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_eofs.plot(col='mode')","key":"ArhsPEJbX2"},{"type":"output","id":"YEe-xnkip36wg-OvozEXx","data":[],"key":"fVo7yruFvC"}],"key":"Otol0GiInq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_pcs.plot(col='mode')","key":"QWFNHQn8CP"},{"type":"output","id":"5pisW4Cz5ZXmsOHQ-nxDI","data":[],"key":"PN8QOQOXvx"}],"key":"bGUej9lGip"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_expvar","key":"tAZT4Grx3R"},{"type":"output","id":"CMkbC3TtPYn2mNTgaE27S","data":[],"key":"NEjTa6k8t3"}],"key":"mLwIJyeJzS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we can see some modes of variability! EOF1 looks like ENSO or IPO, and EOF2 is probably picking up a pattern of the recent temperature trend where the Southern Ocean and southeastern Pacific are slightly cooling. EOF3 and EOF4 appear to be showing some decadal modes of variability (PDO and maybe AMO), among other things. There is a lot going on in each of these maps, so to get a clearer index of some modes, we can restrict our domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d4Dc3s568p"}],"key":"octdW3bZNI"}],"key":"DMqPkRDZ4I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"El Niño Southern Oscillation (ENSO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M2fXCYusD9"}],"identifier":"el-ni-o-southern-oscillation-enso","label":"El Niño Southern Oscillation (ENSO)","html_id":"el-ni-o-southern-oscillation-enso","implicit":true,"key":"PdukorujaL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we restrict our domain to the equatorial Pacific. Note that ENSO is commonly defined using an index of SST anomaly over a region of the equatorial Pacific (e.g., the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KBN52imHL8"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/enso/sst","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Oceanic Niño Index (ONI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qTtBkXnbCT"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/enso/sst","key":"zJ9kejWM9Q"},{"type":"text","value":") instead of an EOF. You can ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"BxV4qaObs9"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/enso/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"read more about ENSO here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oCcjFm2pik"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/enso/","key":"T8NbUps5fG"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XStkeCG7oM"}],"key":"UbtLvt4MKI"}],"key":"LyjcmbOB0r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_ssta_dt = ssta_dt.where((ssta_dt.lat < 30) & (ssta_dt.lat > -30) & (ssta_dt.lon > 120) & (ssta_dt.lon < 290), drop=True)","key":"cdFklCheEi"},{"type":"output","id":"MCcxkvFsAIcSo69Ku41xP","data":[],"key":"nxKnf9hwd3"}],"key":"YzdlN5rRmu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_model = xe.single.EOF(n_modes=4, use_coslat=True)\nep_model.fit(ep_ssta_dt, dim='time')\nep_eofs = ep_model.components()\nep_pcs = ep_model.scores()\nep_expvar = ep_model.explained_variance_ratio()","key":"GLMyRujH5B"},{"type":"output","id":"1VCMLCXxufz2IVZvBYcEm","data":[],"key":"kD74kLy1wE"}],"key":"EHoJ3PduKX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_eofs.plot(col='mode')","key":"W7Wmnteisz"},{"type":"output","id":"ZrhHyIrArvaDm1sJNTaZ1","data":[],"key":"oguaPcZSrw"}],"key":"CMTmWmLnJ3"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"ep_pcs.plot(col='mode')","key":"oTf524XsJo"},{"type":"output","id":"tnA6YcEWYTZr43vLcSBZG","data":[],"key":"CFYulGrNGJ"}],"key":"rD2lP5bnoa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ep_expvar","key":"n3E9u9FpDc"},{"type":"output","id":"d9padV9m_6KdF8j-CxXv8","data":[],"key":"QIUh2kHEjz"}],"key":"LYkwyZL96o"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) < 0), color='b')\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(ep_pcs.time.min(), ep_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('ENSO Index (detrended equatorial Pacific SSTA EOF1)')","key":"oJGr3OmxzW"},{"type":"output","id":"r3i5hbWNWardMIUhJFiGs","data":[],"key":"bSitGtg0cV"}],"key":"OlpPa0UBK9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare to the ONI:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t23J6bNUzi"}],"key":"C1nHbdv1nz"}],"key":"HuyUMrWGK8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(ep_pcs.time, ep_pcs.isel(mode=0).where(ep_pcs.isel(mode=0) < 0), color='b')\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(ep_pcs.time.sel(time='1950-01').squeeze(), ep_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('ENSO Index (detrended equatorial Pacific SSTA EOF1)')","key":"gHwzk0ajhj"},{"type":"output","id":"aC6TURLGnSbtgAl7zWNih","data":[],"key":"LnxKwA1UJ9"}],"key":"SS5MOw3Edh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"image","url":"/eofs-cookbook/build/oni-4f6f78161ab1229fb3c503cb792e79ba.png","alt":"ONI","key":"XOIwgzcuKy","urlSource":"images/oni.png"}],"key":"kSz9F9UTU8"}],"key":"izWmKLiXYA"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Pacific Decadal Oscillation (PDO)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IXDNnJlxff"}],"identifier":"pacific-decadal-oscillation-pdo","label":"Pacific Decadal Oscillation (PDO)","html_id":"pacific-decadal-oscillation-pdo","implicit":true,"key":"RvDLZmg6nD"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Here we restrict our domain to the North Pacific. You can ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u9kEgpchyN"},{"type":"link","url":"https://www.ncei.noaa.gov/access/monitoring/pdo/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"read more about PDO here","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EpTID5fshA"}],"urlSource":"https://www.ncei.noaa.gov/access/monitoring/pdo/","key":"DkfisTioom"},{"type":"text","value":".","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sEoHtLDhzE"}],"key":"svdWnWI7e7"}],"key":"yMoc0vyUir"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_ssta_dt = ssta_dt.where((ssta_dt.lat < 70) & (ssta_dt.lat > 20) & (ssta_dt.lon > 120) & (ssta_dt.lon < 260), drop=True)","key":"g8DxDoqC5g"},{"type":"output","id":"ym7Y6UMOPn9sBRAOJ_xXI","data":[],"key":"vRCcw1HJfn"}],"key":"yDcI0Uv6IM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_model = xe.single.EOF(n_modes=4, use_coslat=True)\nnp_model.fit(np_ssta_dt, dim='time')\nnp_eofs = np_model.components()\nnp_pcs = np_model.scores()\nnp_expvar = np_model.explained_variance_ratio()","key":"tr7JTfuJmR"},{"type":"output","id":"hTzm49TYbIDwvDzm3vtfA","data":[],"key":"UlIKhW81Yb"}],"key":"uraJZtAPVJ"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"np_eofs.plot(col='mode')","key":"IvFDnRNpup"},{"type":"output","id":"DspXkKrxUhv5wJGGmk_E2","data":[],"key":"w7PXeJgw6m"}],"key":"sqYKiYK9KM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_pcs.plot(col='mode')","key":"MgMxkxMiB0"},{"type":"output","id":"Y2iTlbgjOhdTz7HME9xZw","data":[],"key":"uEvUVn99t6"}],"key":"BIgqEA72rJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"np_expvar","key":"h3bIl4w2vw"},{"type":"output","id":"JzjAMjjre9_hfz1ZlB82G","data":[],"key":"AbPLk6qyVK"}],"key":"olPdfbdnm9"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(1, 1, figsize=(10, 2), dpi=130)\nplt.fill_between(np_pcs.time, np_pcs.isel(mode=0).where(np_pcs.isel(mode=0) > 0), color='r')\nplt.fill_between(np_pcs.time, np_pcs.isel(mode=0).where(np_pcs.isel(mode=0) < 0), color='b')\nplt.plot(np_pcs.time, np_pcs.isel(mode=0).rolling(time=48, center=True).mean(), color='k', linewidth=2)\nplt.ylabel('PC')\nplt.xlabel('Year')\nplt.xlim(np_pcs.time.min(), np_pcs.time.max())\nplt.grid(linestyle=':')\nplt.title('PDO Index (detrended North Pacific SSTA EOF1)')","key":"ObFGzmGeIz"},{"type":"output","id":"pQG-nQM_YcM6G95J2JGJc","data":[],"key":"iaEVZoz3WN"}],"key":"FmPeE7k9mD"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZdjdQ1yrJs"}],"key":"a7A0OH7U6B"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bl4YVIWSM8"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"cIKAD8i4GA"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we demonstrated a basic workflow for performing an EOF analysis on gridded SST data using the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jTQqVJ2xNw"},{"type":"inlineCode","value":"xeofs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ZCesumImBX"},{"type":"text","value":" package. We plotted the PCs associated with ENSO and PDO using deseasonalized, detrended SSTs.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pUthV6wd6U"}],"key":"fhpzG9kCew"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Qi5GMSDXUM"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"oG3T6HWTyR"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the future, additional notebooks may use EOFs to recreate published figures, give an overview of other EOF packages, or explore variations of the EOF method.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"n4UYFlkhaN"}],"key":"YpneUkgl9d"}],"key":"qF5Pcn9fIg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S9ChhKuOKN"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"C0v78HvFku"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Scientific description of the ERSSTv5 data set: ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dxCDmiQbGm"},{"type":"cite","url":"https://doi.org/10.1175/jcli-d-16-0836.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Huang et al. (2017), doi:10.1175/jcli-d-16-0836.1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D4CESgHQ8C"}],"kind":"narrative","label":"Huang:2017a","identifier":"https://doi.org/10.1175/jcli-d-16-0836.1","enumerator":"1","key":"pAncwXUU5m"}],"key":"bRjujQ0i35"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"link","url":"https://xeofs.readthedocs.io/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"xeofs documentation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mRrNmuOuNp"}],"urlSource":"https://xeofs.readthedocs.io/","key":"xy1ev0z3Ti"}],"key":"RiZsb3veTy"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Paper describing the xeofs software: ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d3PCxZDeEI"},{"type":"cite","url":"https://doi.org/10.21105/joss.06060","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Rieger et al., (2024) doi:10.21105/joss.06060","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rn04Q7xqvi"}],"kind":"narrative","label":"Rieger:2024a","identifier":"https://doi.org/10.21105/joss.06060","enumerator":"2","key":"jcwCGk4jHp"}],"key":"Q3HnNaCims"}],"key":"PMb3hpKTNf"}],"key":"mBk0GRViw2"}],"key":"T65dA34KkG"},"references":{"cite":{"order":["Huang:2017a","Rieger:2024a"],"data":{"Huang:2017a":{"label":"Huang:2017a","enumerator":"1","doi":"10.1175/JCLI-D-16-0836.1","html":"Huang, B., Thorne, P. W., Banzon, V. F., Boyer, T., Chepurin, G., Lawrimore, J. H., Menne, M. J., Smith, T. M., Vose, R. S., & Zhang, H.-M. (2017). Extended Reconstructed Sea Surface Temperature, Version 5 (ERSSTv5): Upgrades, Validations, and Intercomparisons. <i>Journal of Climate</i>, <i>30</i>(20), 8179–8205. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1175/JCLI-D-16-0836.1\">10.1175/JCLI-D-16-0836.1</a>","url":"https://doi.org/10.1175/JCLI-D-16-0836.1"},"Rieger:2024a":{"label":"Rieger:2024a","enumerator":"2","doi":"10.21105/joss.06060","html":"Rieger, N., & Levang, S. J. (2024). xeofs: Comprehensive EOF analysis in Python with xarray. <i>Journal of Open Source Software</i>, <i>9</i>(93), 6060. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.21105/joss.06060\">10.21105/joss.06060</a>","url":"https://doi.org/10.21105/joss.06060"}}}},"footer":{"navigation":{"prev":{"title":"EOFs with NumPy","url":"/notebooks/numpy-eofs","group":"Foundations"}}},"domain":"http://localhost:3000"}